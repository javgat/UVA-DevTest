<app-nav-bar></app-nav-bar>
<div class="alert alert-{{getMensaje().type}}" *ngIf="getMensaje().mostrar" id="message" role="alert">
    {{getMensaje().texto}}</div>
<h3 *ngIf="equipo.isSoloProfesores()">Equipo de profesores</h3>
<h3 *ngIf="!equipo.isSoloProfesores()">Equipo de estudiantes</h3>
<h2>{{equipo.getTeamname()}}</h2>
<h3><small class="text-muted">{{equipo.getDescription()}}</small></h3>
<button data-bs-toggle="modal" data-bs-target="#updateTeamModal" class="button btn btn-primary"
    *ngIf="checkTeamAdmin()">Modificar Datos</button>
<!-- Modal modificar -->
<div class="modal fade" id="updateTeamModal" tabindex="-1" aria-labelledby="updateTeamModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form ngNativeValidate>
                <div class="modal-header">
                    <h5 class="modal-title" id="updateTeamModalLabel">Modificar equipo</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cancelar"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="inputTeamname" class="form-label">Nombre del equipo</label>
                        <input type="text" class="form-control" name="inputTeamname" aria-describedby="teamnameHelp"
                            [(ngModel)]="teamEdit.teamname" required />
                        <div id="teamnameHelp" class="form-text text-muted">El nombre único del équipo</div>
                    </div>
                    <div class="mb-3">
                        <label for="inputDescription" class="form-label">Descripción</label>
                        <input type="text" class="form-control" name="inputDescription"
                            aria-describedby="descriptionHelp" [(ngModel)]="teamEdit.description" />
                        <div id="descriptionHelp" class="form-text text-muted">Información detallada del equipo
                            (opcional)</div>
                    </div>
                </div>
                <div class="modal-footer">
                    <input type="submit" class="btn btn-success" role="button" data-bs-dismiss="modal" (click)="updateTeamClick()" value="Guardar"/>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="my-4">
    <h4>Administradores:</h4>
    <table class="table table-striped table-hover table-primary">
        <thead>
            <tr>
                <th>Nombre de usuario</th>
                <th>Correo electrónico</th>
                <th>Nombre completo</th>
                <th></th>
            </tr>
        </thead>
        <tbody *ngFor="let admin of admins">
            <tr>
                <td><a class="link-dark" [routerLink]="['/profile', admin.username]">{{admin.username}}</a></td>
                <td>{{admin.email}}</td>
                <td>{{admin.fullname}}</td>
                <td style="width:1%">
                    <div class="btn-group dropstart" role="button">
                        <a data-bs-toggle="dropdown" class="link-dark" aria-expanded="false">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-list" viewBox="0 0 16 16">
                                <path fill-rule="evenodd"
                                    d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z" />
                            </svg>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" *ngIf="checkTeamAdmin()"
                                    (click)="putMemberClick(admin.username)">Retirar permisos de administrador</a></li>
                        </ul>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="my-4">
    <h4>Miembros:</h4>
    <div *ngIf="checkTeamAdmin()">
        <form (ngSubmit)='addMemberSubmit()' ngNativeValidate>
            <div class="input-group my-3">
                <input class="button btn btn-primary" type="submit" value="Añadir miembro" />
                <input type="text" class="form-control" name="inputAddMember" aria-describedby="inputAddMemberHelp"
                    [(ngModel)]="addMiembroUsername" placeholder="Nombre de usuario" required pattern="[^@]+" />
            </div>
        </form>
    </div>
    <table class="table table-striped table-hover table-primary">
        <thead>
            <tr>
                <th>Nombre de usuario</th>
                <th>Correo electrónico</th>
                <th>Nombre completo</th>
                <th></th>
            </tr>
        </thead>
        <tbody *ngFor="let miembro of miembros">
            <tr>
                <td><a class="link-dark" [routerLink]="['/profile', miembro.username]">{{miembro.username}}</a></td>
                <td>{{miembro.email}}</td>
                <td>{{miembro.fullname}}</td>
                <td style="width:1%">
                    <div class="btn-group dropstart" role="button">
                        <a data-bs-toggle="dropdown" class="link-dark" aria-expanded="false">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-list" viewBox="0 0 16 16">
                                <path fill-rule="evenodd"
                                    d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z" />
                            </svg>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" *ngIf="checkTeamAdmin()"
                                    (click)="putAdminClick(miembro.username)">Convertir en administrador</a></li>
                            <li><a class="dropdown-item" *ngIf="checkTeamAdmin()"
                                    (click)="mighDeleteClick(miembro.username)" data-bs-toggle="modal"
                                    data-bs-target="#deleteModal">Expulsar</a></li>
                        </ul>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <!-- Modal expulsar -->
    <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteModalLabel">¿Expulsar a
                        {{mightKickUsername}}?</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cancelar"></button>
                </div>
                <div class="modal-body">
                    ¿Expulsar a {{mightKickUsername}}?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal"
                        (click)="deleteMemberClick(mightKickUsername)">Expulsar</button>
                </div>
            </div>
        </div>
    </div>

</div>